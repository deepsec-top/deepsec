- ID: wa-005
  Category: Web攻击
  Created_At: 2025-07-31
  Contributors: 
    - ZacharyRiser
  Additional_Info: |
    - SQL注入漏洞导致的服务器完全沦陷
    - 展示了从SQL注入到执行远控、植入后门的完整攻击链
    - 涉及powershell.exe和mshta.exe等后渗透工具
  Title_CN: Web攻击-SQL注入后渗透攻击
  Title_EN: web attack - sql injection post-exploitation
  Question: |
    请以SOC团队的指挥官身份，评估并决策以下安全事件：
    - 组织背景：某政府单位，其业务系统采用Web服务器与数据库服务器分离的架构。
    - 事件描述：安全告警系统(天眼)上报了一次SQL注入攻击。
    - 上下文：经排查，攻击者利用了业务服务器登录处的SQL注入漏洞，成功在数据库服务器上执行了任意命令，运行了powershell.exe和mshta.exe等进程建立远程控制。随后，攻击者又在业务服务器上上传了Webshell后门(1.aspx)并创建了隐藏账户，最终导致两台服务器均被攻陷。
    
    作为SOC团队的指挥官，请你对安全事件作出评估并决策。
  Complex_CoT: |

  Response: |

# ---
# [Note] Case Study Value:
# 1. 展示SQL注入的完整后果：与wa-001(探测)不同，本案例完整地展示了从SQL注入成功到服务器完全沦陷的后渗透全过程。
# 2. 引入“Living off the Land”战术：首次清晰地展示了攻击者利用powershell.exe和mshta.exe等系统内置工具进行恶意活动的场景。
# 3. 揭示架构安全误区：通过“站库分离”架构下两台服务器均被攻陷的案例，深刻揭示了架构分离不等于安全隔离。
# 4. 组合持久化手段：同时展示了Webshell和隐藏账户两种不同的持久化技术。